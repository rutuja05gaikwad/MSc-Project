import boto3


def setup_sns_topic():
    sns_client = boto3.client('sns')
    
    # Create SNS Topic
    response = sns_client.create_topic(Name='S3FileScanAlerts')
    sns_topic_arn = response['TopicArn']
    
    print(f"SNS topic created: {sns_topic_arn}")
    return sns_topic_arn

def subscribe_to_sns_topic(topic_arn, protocol, endpoint):
    sns_client = boto3.client('sns')
    
    # Subscribe to the SNS Topic
    sns_client.subscribe(
        TopicArn=topic_arn,
        Protocol=protocol,
        Endpoint=endpoint
    )
    
    print(f"Subscribed {endpoint} to topic {topic_arn}")
